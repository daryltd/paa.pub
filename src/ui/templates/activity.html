<h1>Activity</h1>
{{#error}}
<div class="error">{{error}}</div>
{{/error}}

<div class="card">
  <h2>Compose</h2>
  <form method="POST" action="/compose">
    <div class="form-group">
      <textarea name="content" placeholder="What's on your mind?" required></textarea>
    </div>
    <div class="form-group">
      <label for="audience">Audience</label>
      <select name="audience" id="audience">
        <option value="public">Public</option>
        <option value="unlisted">Unlisted</option>
        <option value="followers">Followers Only</option>
        <option value="private">Private</option>
      </select>
    </div>
    <div class="form-group">
      <input type="text" name="summary" placeholder="Content warning (optional)">
    </div>
    <button type="submit" class="btn">Post</button>
  </form>
</div>

{{#hasPendingRequests}}
<div class="card">
  <h2>Follow Requests ({{pendingCount}})</h2>
  <ul class="list-plain">
    {{#pendingRequests}}
    <li class="follow-request-item">
      <span class="mono flex-1 text-sm truncate">{{actor}}</span>
      <span class="text-muted text-xs nowrap">{{receivedAt}}</span>
      <form method="POST" action="/follow-requests/accept" class="inline-form">
        <input type="hidden" name="target" value="{{actor}}">
        <button type="submit" class="btn btn-xs">Accept</button>
      </form>
      <form method="POST" action="/follow-requests/reject" class="inline-form">
        <input type="hidden" name="target" value="{{actor}}">
        <button type="submit" class="btn btn-secondary btn-xs">Reject</button>
      </form>
    </li>
    {{/pendingRequests}}
  </ul>
</div>
{{/hasPendingRequests}}

<div class="card">
  <h2>Follow / Unfollow</h2>
  <form method="POST" action="/follow" class="flex gap-05 mb-05">
    <input type="text" name="target" placeholder="user@domain.com or actor URL" class="flex-1">
    <button type="submit" class="btn">Follow</button>
  </form>
  {{#hasFollowing}}
  <details>
    <summary class="text-muted">{{followingCount}} following</summary>
    <ul class="list-plain mt-05">
      {{#following}}
      <li class="list-row">
        <a href="{{feedUrl}}" class="mono flex-1 text-sm truncate">{{uri}}</a>
        <form method="POST" action="/unfollow" class="inline-form">
          <input type="hidden" name="target" value="{{uri}}">
          <button type="submit" class="btn btn-secondary btn-xs">Unfollow</button>
        </form>
      </li>
      {{/following}}
    </ul>
  </details>
  {{/hasFollowing}}
  {{#hasFollowers}}
  <details class="mt-05">
    <summary class="text-muted">{{followerCount}} followers</summary>
    <ul class="list-plain mt-05">
      {{#followers}}
      <li class="list-row">
        <a href="{{feedUrl}}" class="mono text-sm truncate">{{uri}}</a>
      </li>
      {{/followers}}
    </ul>
  </details>
  {{/hasFollowers}}
</div>

<div>
  <div class="flex justify-between items-center">
    <h2>Activity Feed <span class="text-muted text-sm font-normal">(latest {{feedLimit}})</span></h2>
    <div class="flex gap-05">
      {{#showAll}}
      <a href="/activity" class="btn btn-secondary btn-xs">Hide read</a>
      {{/showAll}}
      {{^showAll}}
      <a href="/activity?show=all" class="btn btn-secondary btn-xs">Show all</a>
      {{/showAll}}
      {{#hasActivities}}
      <form method="POST" action="/activity/mark-all-read" class="inline-form">
        <button type="submit" class="btn btn-secondary btn-xs">Mark all as read</button>
      </form>
      {{/hasActivities}}
    </div>
  </div>
  {{^hasActivities}}
  <div class="card text-muted">No activities yet.</div>
  {{/hasActivities}}
  {{#activities}}
  <div class="card">
    <div class="flex justify-between mb-05">
      <span class="mono text-sm">{{actor}}</span>
      <span class="text-muted">{{published}}</span>
    </div>
    <div class="flex gap-05 mb-05">
      <span class="badge badge-type">{{type}}</span>
      {{#isReceived}}<span class="badge badge-received">{{source}}</span>{{/isReceived}}
      {{^isReceived}}<span class="badge badge-sent">{{source}}</span>{{/isReceived}}
      <form method="POST" action="/activity/mark-read" class="inline-form">
        <input type="hidden" name="id" value="{{activityId}}">
        <button type="submit" class="btn btn-secondary btn-xs">Mark as read</button>
      </form>
    </div>
    {{#isCreate}}
      {{#hasSummary}}<div class="text-muted"><em>CW: {{summary}}</em></div>{{/hasSummary}}
      <div>{{{content}}}</div>
    {{/isCreate}}
    {{#isFollow}}
      <div class="text-muted">Follow â†’ {{target}}</div>
    {{/isFollow}}
    {{#isAccept}}
      <div class="text-muted">Accepted activity</div>
    {{/isAccept}}
    {{#isUndo}}
      <div class="text-muted">Undid activity</div>
    {{/isUndo}}
    {{#isOther}}
      <div class="text-muted">{{type}} activity</div>
    {{/isOther}}
  </div>
  {{/activities}}
</div>
